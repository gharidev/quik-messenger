{"version":3,"sources":["webpack:///./src/views/Chats.vue?207e","webpack:///./src/components/Users.vue?c788","webpack:///src/components/Users.vue","webpack:///./src/components/Users.vue?fb6d","webpack:///./src/components/Users.vue","webpack:///src/views/Chats.vue","webpack:///./src/views/Chats.vue?c613","webpack:///./src/views/Chats.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_l","chat","key","id","on","$event","openChat","_s","getUserNameFromId","attrs","chats","staticRenderFns","user","uid","startChat","displayName","data","users","props","computed","currentUser","$store","getters","filteredUsers","filter","methods","length","db","$router","push","firestore","created","console","log","component","chatUsers","components","Users","watch","userIdList","VContainer","VMain"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACA,EAAG,cAAc,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAG,WAAWN,EAAIO,GAAIP,EAAS,OAAE,SAASQ,GAAM,OAAOJ,EAAG,IAAI,CAACK,IAAID,EAAKE,GAAGC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOZ,EAAIa,SAASL,MAAS,CAACR,EAAIM,GAAG,IAAIN,EAAIc,GAAGN,EAAKE,GAAK,KAAOV,EAAIe,kBAAkBP,EAAKE,KAAK,UAASN,EAAG,QAAQ,CAACY,MAAM,CAAC,MAAQhB,EAAIiB,UAAU,IAAI,IACvYC,EAAkB,G,gECDlB,EAAS,WAAa,IAAIlB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAG,WAAWN,EAAIO,GAAIP,EAAiB,eAAE,SAASmB,GAAM,OAAOf,EAAG,IAAI,CAACK,IAAIU,EAAKC,IAAIT,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOZ,EAAIqB,UAAUF,MAAS,CAACnB,EAAIM,GAAG,IAAIN,EAAIc,GAAGK,EAAKC,IAAM,KAAOD,EAAKG,aAAa,WAAU,IACnU,EAAkB,GCStB,GACEC,KADF,WAEI,MAAO,CACLC,MAAO,KAGXC,MAAO,CAAC,SACRC,SAAU,CACRC,YADJ,WAEM,OAAO1B,KAAK2B,OAAOC,QAAQF,aAE7BG,cAJJ,WAIA,WACM,OAAO7B,KAAKuB,MAAMO,QAAO,SAA/B,wCAGEC,QAAS,CACPX,UADJ,SACA,cACM,GAAIF,EAAKC,KAAOnB,KAAK0B,YAAYP,IAAjC,CACA,IAAN,kEAC0B,GAAhBH,EAAMgB,OACRC,EAAR,yBACA,KACU,MAAV,6BACU,UAAV,EACU,SAAV,GACU,QAAV,eAEA,kBACU,EAAV,+BAGQjC,KAAKkC,QAAQC,KAAK,SAAWnB,EAAM,GAAGP,OAI5C2B,UAAW,CACTb,MAAOU,EAAX,0BAEEI,QAtCF,WAuCIC,QAAQC,IAAIvC,KAAK0B,eCjD0T,I,YCO3Uc,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,QCJf,GACElB,KADF,WAEI,MAAO,CACLN,MAAO,KACPyB,UAAW,KAGfC,WAAY,CACVC,MAAJ,GAEElB,SAAU,CACRC,YADJ,WAEM,OAAO1B,KAAK2B,OAAOC,QAAQF,cAG/BkB,MAAO,CACL5B,MADJ,SACA,cACA,qBAEQ,OADAsB,QAAQC,IAAI,OAAQhC,GACbA,EAAKgB,MAAMO,QAAO,SAAjC,wCAEA,KACMQ,QAAQC,IAAIM,GACa,GAArBA,EAAWb,QACfC,EAAN,yBACA,oBACA,MACA,kBACQ,EAAR,0BACU,EAAV,qBACA,iCACA,qBAEU,EAAV,YACU,QAAV,4BAKEF,QAAS,CACPjB,kBADJ,SACA,SACM,OAAN,+DAEIF,SAJJ,SAIA,GACMZ,KAAKkC,QAAQC,KAAK,SAAW5B,EAAKE,MAGtC4B,QA/CF,WAgDSrC,KAAKgB,OACd,WACA,QACA,OACA,oBACA,wDCnE+U,I,6CCO3U,EAAY,eACd,EACAlB,EACAmB,GACA,EACA,KACA,KACA,MAIa,eAAiB,QAMhC,IAAkB,EAAW,CAAC6B,aAAA,KAAWC,QAAA","file":"js/chunk-2d217ed6.ad7323f2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-main',[_c('v-container',[_c('h1',[_vm._v(\"Chats\")]),_vm._l((_vm.chats),function(chat){return _c('p',{key:chat.id,on:{\"click\":function($event){return _vm.openChat(chat)}}},[_vm._v(\" \"+_vm._s(chat.id + \", \" + _vm.getUserNameFromId(chat.id))+\" \")])}),_c('users',{attrs:{\"chats\":_vm.chats}})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"Users\")]),_vm._l((_vm.filteredUsers),function(user){return _c('p',{key:user.uid,on:{\"click\":function($event){return _vm.startChat(user)}}},[_vm._v(\" \"+_vm._s(user.uid + \", \" + user.displayName)+\" \")])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h1>Users</h1>\r\n    <p v-for=\"user in filteredUsers\" :key=\"user.uid\" @click=\"startChat(user)\">\r\n      {{ user.uid + \", \" + user.displayName }}\r\n    </p>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { db, Timestamp } from \"../db\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      users: [],\r\n    };\r\n  },\r\n  props: [\"chats\"],\r\n  computed: {\r\n    currentUser() {\r\n      return this.$store.getters.currentUser;\r\n    },\r\n    filteredUsers() {\r\n      return this.users.filter((u) => u.uid != this.currentUser.uid);\r\n    },\r\n  },\r\n  methods: {\r\n    startChat(user) {\r\n      if (user.uid == this.currentUser.uid) return;\r\n      const chats = this.chats.filter((c) => c.users.includes(user.id));\r\n      if (chats.length == 0) {\r\n        db.collection(\"chats\")\r\n          .add({\r\n            users: [this.currentUser.uid, user.uid],\r\n            personal: true,\r\n            messages: [],\r\n            created: Timestamp.now(),\r\n          })\r\n          .then((data) => {\r\n            this.$router.push(\"/chat/\" + data.id);\r\n          });\r\n      } else {\r\n        this.$router.push(\"/chat/\" + chats[0].id);\r\n      }\r\n    },\r\n  },\r\n  firestore: {\r\n    users: db.collection(\"users\"),\r\n  },\r\n  created() {\r\n    console.log(this.currentUser);\r\n  },\r\n};\r\n</script>\r\n<style lang=\"\">\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=2f47e928&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <v-main>\r\n    <v-container>\r\n      <h1>Chats</h1>\r\n      <p @click=\"openChat(chat)\" v-for=\"chat in chats\" :key=\"chat.id\">\r\n        {{ chat.id + \", \" + getUserNameFromId(chat.id) }}\r\n      </p>\r\n      <users :chats=\"chats\"></users>\r\n    </v-container>\r\n  </v-main>\r\n</template>\r\n<script>\r\nimport { db } from \"../db\";\r\nimport Users from \"../components/Users.vue\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      chats: null,\r\n      chatUsers: {},\r\n    };\r\n  },\r\n  components: {\r\n    Users,\r\n  },\r\n  computed: {\r\n    currentUser() {\r\n      return this.$store.getters.currentUser;\r\n    },\r\n  },\r\n  watch: {\r\n    chats(val) {\r\n      const userIdList = val.map((chat) => {\r\n        console.log(\"Chat\", chat);\r\n        return chat.users.filter((u) => u != this.currentUser.uid)[0];\r\n      });\r\n      let chatUsers = {};\r\n      console.log(userIdList);\r\n      if (userIdList.length == 0) return;\r\n      db.collection(\"users\")\r\n        .where(\"uid\", \"in\", userIdList)\r\n        .get()\r\n        .then((data) => {\r\n          data.docs.forEach((user) => {\r\n            val.forEach((chat) => {\r\n              if (chat.users.includes(user.data().uid))\r\n                chatUsers[chat.id] = user.data();\r\n            });\r\n            this.chatUsers = chatUsers;\r\n            console.log(\"Chat Users\", chatUsers);\r\n          });\r\n        });\r\n    },\r\n  },\r\n  methods: {\r\n    getUserNameFromId(chatId) {\r\n      return this.chatUsers[chatId]?.displayName;\r\n    },\r\n    openChat(chat) {\r\n      this.$router.push(\"/chat/\" + chat.id);\r\n    },\r\n  },\r\n  created() {\r\n    if (!this.chats)\r\n      this.$bind(\r\n        \"chats\",\r\n        db\r\n          .collection(\"chats\")\r\n          .where(\"users\", \"array-contains\", this.currentUser.uid)\r\n      );\r\n  },\r\n};\r\n</script>\r\n<style>\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chats.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chats.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chats.vue?vue&type=template&id=13557166&\"\nimport script from \"./Chats.vue?vue&type=script&lang=js&\"\nexport * from \"./Chats.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VMain } from 'vuetify/lib/components/VMain';\ninstallComponents(component, {VContainer,VMain})\n"],"sourceRoot":""}